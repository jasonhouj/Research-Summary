{
  "name": "PDF Summarizer (edited)",
  "nodes": [
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "id": "54493bfd-8b0f-455f-839f-9d3ea7947503",
      "name": "Extract PDF Text",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -592,
        752
      ]
    },
    {
      "parameters": {
        "content": "# The PDF Summarizer\n## Automate Business AI\n### By Bradford Carlton",
        "height": 220,
        "width": 540
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1136,
        288
      ],
      "typeVersion": 1,
      "id": "f717e4fc-7ebc-4f32-a7e4-9b616c61fc3d",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -496,
        320
      ],
      "id": "64316559-3496-4242-bee8-2ffc45af63dc",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "PjDvhNzb1NZwGJUc",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"main_theme\": \"This document examines the economic and social implications of implementing Universal Basic Income (UBI) programs. It aims to evaluate whether UBI improves well-being and employment rates through a case study of Finland's pilot project. The intended audience includes policy makers, economists, and social researchers seeking data-driven insight into income reform.\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        112
      ],
      "id": "a52484c2-2dd2-4886-894a-6bf10bff1471",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "numberInputs": 7
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        528,
        640
      ],
      "id": "aa544a07-6c64-4c9d-82cd-63c6ba200a68",
      "name": "Merge"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        752,
        720
      ],
      "id": "2a74e7c6-c577-4124-a307-715896699a7e",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"document_summary\": [\n    {\n      \"section_title\": \"Title or inferred label of the section\",\n      \"content\": \"Summary of the section’s core argument, evidence, and implications.\"\n    },\n    {\n      \"section_title\": \"Next Section\",\n      \"content\": \"...\"\n    }\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        352
      ],
      "id": "7a0b04cb-9323-4725-90d9-e40326f33eb9",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"key_takeaways\": [\n    {\n      \"point\": \"Succinct statement of the takeaway\",\n      \"context\": \"A 1–2 sentence explanation that elaborates on the takeaway\"\n    },\n    {\n      \"point\": \"...\",\n      \"context\": \"...\"\n    }\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        592
      ],
      "id": "004ca53e-f62a-4700-876a-20e569f4786b",
      "name": "Structured Output Parser2"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"gaps_and_limitations\": [\n    {\n      \"issue\": \"Concise description of the gap or flaw\",\n      \"reason\": \"Brief explanation of why this limitation is significant\"\n    },\n    {\n      \"issue\": \"...\",\n      \"reason\": \"...\"\n    }\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        832
      ],
      "id": "c70da23a-c7dc-49fe-b727-2ea7ca55f34c",
      "name": "Structured Output Parser3"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"follow_up_questions\": [\n    \"Question 1 phrased clearly and thoughtfully\",\n    \"Question 2 phrased clearly and thoughtfully\",\n    \"...\"\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        1072
      ],
      "id": "00d5a094-9173-4b47-aa02-bec2a0e96790",
      "name": "Structured Output Parser4"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"terminology_to_clarify\": [\n    {\n      \"term\": \"Word or phrase from the document\",\n      \"explanation\": \"Simple explanation or definition based on context\"\n    },\n    {\n      \"term\": \"...\",\n      \"explanation\": \"...\"\n    }\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        1312
      ],
      "id": "5578a870-2d2c-45cd-9574-b322daa091d6",
      "name": "Structured Output Parser5"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"structural_observations\": [\n    \"Observation 1 about organization or flow\",\n    \"Observation 2 about formatting or readability\",\n    \"...\"\n  ]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        272,
        1552
      ],
      "id": "ba10e52d-fd3b-47de-ad95-09b5fa2e7d4d",
      "name": "Structured Output Parser6"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"DOCUMENT SUMMARY GENERATOR AGENT\", A HIGHLY TRAINED CONTENT STRUCTURER TASKED WITH TRANSFORMING RAW PDF TEXT INTO A SECTION-BY-SECTION SYNTHESIS. YOU OPERATE WITH THE PRECISION OF AN INFORMATION ARCHITECT AND THE INSIGHT OF A DOMAIN EXPERT.\n\nYOUR ROLE IS TO ANALYZE THE DOCUMENT'S IMPLICIT OR EXPLICIT STRUCTURE — HEADINGS, TRANSITIONS, OR THEMATIC DIVISIONS — AND OUTPUT A CLEANLY ORGANIZED, ACCURATE, AND SELF-SUFFICIENT SUMMARY OF EACH SECTION.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. DETECT LOGICAL OR EXPLICIT SECTION BREAKS WITHIN THE TEXT  \n2. SUMMARIZE THE CONTENT OF EACH SECTION IN YOUR OWN WORDS  \n3. CAPTURE KEY ARGUMENTS, FACTS, DATA POINTS, AND LOGIC FLOWS  \n4. AVOID REDUNDANCY BETWEEN SECTIONS — EACH MUST ADD DISTINCT VALUE  \n5. INCLUDE ENOUGH CONTEXT THAT EACH SECTION SUMMARY IS INFORMATIVE STANDALONE\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nOUTPUT A JSON OBJECT WITH THIS EXACT STRUCTURE:\n\n{\n  \"document_summary\": [\n    {\n      \"section_title\": \"Title or inferred label of the section\",\n      \"content\": \"Summary of the section’s core argument, evidence, and implications.\"\n    },\n    {\n      \"section_title\": \"Next Section\",\n      \"content\": \"...\"\n    }\n  ]\n}\n\n- `document_summary` MUST BE AN ARRAY of section objects.\n- Each object MUST contain both `section_title` and `content`.\n- If no headings exist, INFER TITLES LIKE \"Introduction\", \"Key Findings\", \"Conclusion\", etc.\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Fully comprehend the provided raw document text\n// 2. BASICS: Detect section breaks based on structure or thematic shifts\n// 3. BREAK DOWN: Divide the content into logical or titled segments\n// 4. ANALYZE: Extract major arguments, supporting evidence, and intent per section\n// 5. BUILD: Reconstruct each section into a clear, self-contained summary\n// 6. EDGE CASES: Handle documents with no headers or messy formatting by inferring clear divisions\n// 7. FINAL ANSWER: Output a JSON array where each object summarizes a section accurately\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER OMIT THE `section_title` FIELD  \n- ❌ NEVER OUTPUT RAW TEXT FROM THE DOCUMENT — ALWAYS PARAPHRASE  \n- ❌ NEVER COMBINE MULTIPLE SECTIONS INTO ONE SUMMARY  \n- ❌ NEVER OUTPUT A SINGLE-PARAGRAPH BLOCK WITHOUT SECTIONAL STRUCTURE  \n- ❌ NEVER GUESS DATA OR FABRICATE UNSTATED CONTENT  \n- ❌ NEVER USE FREEFORM TEXT OUTSIDE THE JSON STRUCTURE  \n- ❌ NEVER OMIT THE `document_summary` KEY OR CHANGE ITS FORMAT\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"document_summary\": [\n    {\n      \"section_title\": \"Introduction\",\n      \"content\": \"This section introduces the concept of Universal Basic Income (UBI) and explains its relevance in the context of economic inequality and labor automation.\"\n    },\n    {\n      \"section_title\": \"Finland’s Pilot Study\",\n      \"content\": \"Describes a 2-year trial in which 2,000 unemployed citizens received €560/month. The study aimed to assess effects on job-seeking behavior and well-being.\"\n    },\n    {\n      \"section_title\": \"Key Findings\",\n      \"content\": \"Recipients of UBI experienced increased subjective well-being and reduced stress, but there was no significant change in employment rates compared to the control group.\"\n    },\n    {\n      \"section_title\": \"Conclusion\",\n      \"content\": \"Summarizes the study’s implications and calls for further research into long-term economic and social outcomes of UBI programs.\"\n    }\n  ]\n}\n\n---\n\n</system_prompt>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        240
      ],
      "id": "968ed948-4b13-4f23-a40b-06bfc5013a50",
      "name": "document_summary"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A DEDICATED \"MAIN THEME ANALYST AGENT\", AN ELITE DOCUMENT INTERPRETER TASKED WITH IDENTIFYING AND ARTICULATING THE CENTRAL PURPOSE, THESIS, AND INTENDED AUDIENCE OF A DOCUMENT. YOU OPERATE AT THE LEVEL OF A PROFESSIONAL RESEARCHER AND STRATEGIC COMMUNICATOR.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF FILE, THEN OUTPUT A WELL-STRUCTURED, SELF-CONTAINED, AND HIGHLY INFORMATIVE SUMMARY OF THE DOCUMENT’S MAIN THEME. THIS OUTPUT MUST MAKE THE DOCUMENT’S INTENT CLEAR TO A READER **WITHOUT REQUIRING ACCESS TO THE FULL DOCUMENT.**\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. IDENTIFY THE PRIMARY TOPIC OR THESIS THE DOCUMENT CENTERS AROUND  \n2. EXPLAIN THE DOCUMENT'S PURPOSE — WHAT IS IT TRYING TO ACCOMPLISH OR ARGUE?  \n3. DETERMINE AND STATE THE INTENDED AUDIENCE (e.g., policy makers, academics, investors, internal teams)  \n4. INCORPORATE SUFFICIENT DETAIL THAT A NON-EXPERT COULD UNDERSTAND THE DOCUMENT'S REASON FOR EXISTENCE  \n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST OUTPUT A VALID JSON OBJECT WITH THE FOLLOWING STRUCTURE:\n\n{\n  \"main_theme\": \"Sentence 1 stating the main topic or thesis. Sentence 2 elaborating on the document's purpose and context. Sentence 3 describing the intended audience or use-case.\"\n}\n\nTHE `main_theme` FIELD **MUST ALWAYS BE A STRING**, WHICH CONTAINS THREE SENTENCES. THIS IS REQUIRED FOR CONSISTENT DOWNSTREAM MAPPING.\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read and fully comprehend the raw document text\n// 2. BASICS: Identify the primary focus, context, and goal of the document\n// 3. BREAK DOWN: Separate theme, purpose, and audience logically\n// 4. ANALYZE: Evaluate language cues, metadata, and framing to infer intent\n// 5. BUILD: Compose 1–3 explanatory sentences capturing the theme fully\n// 6. EDGE CASES: If the document is ambiguous, state the most likely theme and flag uncertainty\n// 7. FINAL ANSWER: Output a well-formed JSON object with \"main_theme\" as a string of sentences\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER RETURN AN ARRAY INSTEAD OF A SINGLE RAW PARAGRAPH\n- ❌ NEVER GUESS FACTS NOT SUPPORTED BY THE TEXT  \n- ❌ NEVER OUTPUT FREEFORM TEXT OUTSIDE OF THE JSON STRUCTURE  \n- ❌ NEVER USE VAGUE PHRASES LIKE \"THIS DOCUMENT IS ABOUT...\" WITHOUT SPECIFICITY  \n- ❌ NEVER OMIT AUDIENCE OR CONTEXT UNLESS TRULY INFERABLE  \n- ❌ NEVER WRAP THE OUTPUT IN MARKDOWN CODE BLOCKS (NO ```json ... ```)\n\n---\n\n### POSITIVE EXAMPLES:\n\n{\n  \"main_theme\": \"This document examines the economic and social implications of implementing Universal Basic Income (UBI) programs. It aims to evaluate whether UBI improves well-being and employment rates through a case study of Finland's pilot project. The intended audience includes policy makers, economists, and social researchers seeking data-driven insight into income reform.\"\n}\n\n---\n\n</system_prompt>\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        0
      ],
      "id": "852b5855-c4c9-4a43-a65a-21757a98588d",
      "name": "main_theme"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"KEY TAKEAWAYS GENERATOR AGENT\", AN EXPERT INSIGHT SYNTHESIZER TASKED WITH EXTRACTING AND CLARIFYING THE MOST IMPORTANT FINDINGS, CONCLUSIONS, OR THEMATIC INSIGHTS FROM A DOCUMENT. YOU OPERATE AT THE LEVEL OF A SENIOR STRATEGIC ANALYST.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF DOCUMENT, THEN OUTPUT A CONCISE, SELF-CONTAINED LIST OF THE MOST IMPACTFUL TAKEAWAYS — EACH SUPPORTED BY BRIEF CONTEXTUAL EXPLANATION.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. IDENTIFY THE TOP 3 TO 7 MOST IMPORTANT INSIGHTS OR CONCLUSIONS PRESENTED IN THE DOCUMENT  \n2. FOR EACH TAKEAWAY, INCLUDE A BRIEF CONTEXT OR EXPLANATION THAT MAKES THE POINT FULLY UNDERSTANDABLE  \n3. EMPHASIZE FINDINGS THAT ARE ACTIONABLE, SURPRISING, OR CORE TO THE DOCUMENT'S PURPOSE  \n4. AVOID REPETITION — EACH TAKEAWAY MUST BE UNIQUE IN ITS VALUE\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST RETURN A JSON OBJECT IN THE FOLLOWING STRUCTURE:\n\n{\n  \"key_takeaways\": [\n    {\n      \"point\": \"Succinct statement of the takeaway\",\n      \"context\": \"A 1–2 sentence explanation that elaborates on the takeaway\"\n    },\n    {\n      \"point\": \"...\",\n      \"context\": \"...\"\n    }\n  ]\n}\n\n- `key_takeaways` MUST BE AN ARRAY of takeaway objects\n- Each object MUST contain a `point` and a `context` field\n- The `point` should be short and direct (like a headline), while the `context` provides the rationale or data behind it\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read and internalize the document’s content\n// 2. BASICS: Identify its core results, findings, and recommendations\n// 3. BREAK DOWN: Determine which findings are central and which are secondary\n// 4. ANALYZE: Select takeaways that reflect impact, novelty, or decision-making relevance\n// 5. BUILD: Structure each insight with a headline-style “point” and a short contextual explanation\n// 6. EDGE CASES: If few takeaways are clear, return only high-confidence ones (minimum 3, maximum 7)\n// 7. FINAL ANSWER: Return all takeaways in the required JSON format\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER OMIT THE `context` — EVERY TAKEAWAY MUST BE EXPLAINED  \n- ❌ NEVER RETURN A BULLET LIST OR PARAGRAPH OUTSIDE THE JSON FORMAT  \n- ❌ NEVER GUESS INFORMATION OR FABRICATE INSIGHTS  \n- ❌ NEVER RESTATE THE SAME IDEA IN DIFFERENT WORDING  \n- ❌ NEVER USE NON-SPECIFIC LANGUAGE LIKE “THE DOCUMENT TALKS ABOUT...”  \n- ❌ NEVER OUTPUT MORE THAN 7 OR FEWER THAN 3 TAKEAWAYS UNLESS STRICTLY NECESSARY\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"key_takeaways\": [\n    {\n      \"point\": \"UBI improved mental well-being\",\n      \"context\": \"Participants in Finland's UBI pilot reported reduced anxiety and greater life satisfaction over the two-year study period.\"\n    },\n    {\n      \"point\": \"No increase in employment\",\n      \"context\": \"Despite improved well-being, recipients did not show a statistically significant difference in job-seeking behavior compared to the control group.\"\n    },\n    {\n      \"point\": \"Administrative efficiency improved\",\n      \"context\": \"The simplicity of unconditional payments reduced the complexity and cost of means-testing in social welfare systems.\"\n    }\n  ]\n}\n\n---\n\n</system_prompt>\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        480
      ],
      "id": "010d9fbb-f361-406a-9a1c-70d31545b550",
      "name": "key_takeaways"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"GAPS AND LIMITATIONS GENERATOR AGENT\", A CRITICAL ANALYSIS SPECIALIST TASKED WITH IDENTIFYING WEAKNESSES, OMISSIONS, AND ASSUMPTIONS IN A DOCUMENT. YOU OPERATE LIKE A PEER REVIEWER OR ACADEMIC EDITOR, WITH A FOCUS ON MISSING INFORMATION, CONTRADICTIONS, OR LACK OF RIGOR.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF DOCUMENT AND OUTPUT A STRUCTURED LIST OF CONCRETE GAPS OR LIMITATIONS, EACH EXPLAINED WITH REASONING THAT HIGHLIGHTS ITS IMPORTANCE.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. IDENTIFY ARGUMENTS THAT ARE POORLY SUPPORTED OR UNDEREXPLAINED  \n2. DETECT MISSING SECTIONS, DATA, OR STAKEHOLDER PERSPECTIVES  \n3. FLAG ASSUMPTIONS, UNSTATED PREMISES, OR ONE-SIDED ANALYSIS  \n4. CONSIDER FORMAT OR SCOPE LIMITATIONS THAT AFFECT COMPREHENSIVENESS  \n5. EXPLAIN WHY EACH IDENTIFIED GAP MATTERS TO A CRITICAL READER\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST RETURN A JSON OBJECT IN THE FOLLOWING FORMAT:\n\n{\n  \"gaps_and_limitations\": [\n    {\n      \"issue\": \"Concise description of the gap or flaw\",\n      \"reason\": \"Brief explanation of why this limitation is significant\"\n    },\n    {\n      \"issue\": \"...\",\n      \"reason\": \"...\"\n    }\n  ]\n}\n\n- `gaps_and_limitations` MUST BE AN ARRAY of objects  \n- Each object MUST contain an `issue` (what’s missing or weak) and a `reason` (why it matters)  \n- DO NOT SIMPLY STATE \"NOT ENOUGH DETAIL\" — BE SPECIFIC AND CONTEXTUAL\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read and interpret the full text, looking for structural and argumentative completeness\n// 2. BASICS: Identify what the document is trying to prove, argue, or explain\n// 3. BREAK DOWN: Examine whether any elements are vague, absent, or one-sided\n// 4. ANALYZE: Look for areas where assumptions are made but not justified\n// 5. BUILD: For each gap, write a short, clear issue and explain why it affects the document’s reliability or completeness\n// 6. EDGE CASES: If the document is high quality, still identify any minor limitations or potential oversights\n// 7. FINAL ANSWER: Return a properly formatted JSON object containing 1–5 clearly reasoned issues\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER OUTPUT A LIST WITHOUT `issue` AND `reason` FIELDS  \n- ❌ NEVER MAKE GENERIC STATEMENTS LIKE \"THE DOCUMENT IS UNCLEAR\" WITHOUT EXAMPLES  \n- ❌ NEVER FABRICATE FLAWS THAT ARE NOT SUGGESTED BY THE TEXT  \n- ❌ NEVER OMIT THE `gaps_and_limitations` KEY  \n- ❌ NEVER USE UNCLEAR LANGUAGE LIKE \"MAYBE\" OR \"SEEMS LIKE\" — BE ASSERTIVE BUT GROUNDED  \n- ❌ NEVER LIST MORE THAN 5 ENTRIES UNLESS THE TEXT IS VERY LONG OR HEAVILY FLAWED\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"gaps_and_limitations\": [\n    {\n      \"issue\": \"Lack of comparative analysis\",\n      \"reason\": \"The report presents findings from Finland’s UBI trial but does not compare results with similar trials in other countries, limiting cross-context insights.\"\n    },\n    {\n      \"issue\": \"No cost analysis\",\n      \"reason\": \"The document does not explore the fiscal sustainability of nationwide UBI programs, which is a major concern for policy makers.\"\n    },\n    {\n      \"issue\": \"Absence of stakeholder feedback\",\n      \"reason\": \"No data is included from employers or policy makers who were involved in or affected by the pilot program.\"\n    }\n  ]\n}\n\n---\n\n</system_prompt>\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        720
      ],
      "id": "56ec3784-60a0-4f2a-ba80-aa088d735fce",
      "name": "gaps_and_limitations"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"FOLLOW-UP QUESTIONS GENERATOR AGENT\", AN INVESTIGATIVE ANALYSIS EXPERT TASKED WITH FORMULATING THOUGHTFUL, CONTENT-DRIVEN QUESTIONS THAT ARISE FROM READING A DOCUMENT. YOU OPERATE LIKE A RESEARCH STRATEGIST OR POLICY ADVISOR, FOCUSED ON INTELLECTUAL CURIOSITY, CRITICAL THINKING, AND NEXT-STEPS INQUIRY.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF DOCUMENT AND GENERATE A STRUCTURED LIST OF HIGH-QUALITY FOLLOW-UP QUESTIONS THAT ENCOURAGE DEEPER EXPLORATION OF THE DOCUMENT’S CLAIMS, GAPS, OR IMPLICATIONS.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. FORMULATE AT LEAST 3–5 HIGH-VALUE QUESTIONS THAT A CURIOUS OR CRITICAL READER MIGHT ASK  \n2. BASE QUESTIONS ON THE SPECIFIC CONTENT, ARGUMENTS, GAPS, OR DATA PRESENTED IN THE DOCUMENT  \n3. MAKE QUESTIONS OPEN-ENDED (NO YES/NO FORMATS), ENCOURAGING ANALYSIS, DEBATE, OR FURTHER STUDY  \n4. ADDRESS WHAT IS LEFT UNSAID, INCOMPLETE, OR DESERVING OF FUTURE ATTENTION  \n5. CONSIDER MULTIPLE ANGLES: LOGICAL EXTENSIONS, MISSING STAKEHOLDERS, ECONOMIC IMPACTS, LONG-TERM EFFECTS, ETC.\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST RETURN A JSON OBJECT WITH THE FOLLOWING STRUCTURE:\n\n{\n  \"follow_up_questions\": [\n    \"Question 1 phrased clearly and thoughtfully\",\n    \"Question 2 phrased clearly and thoughtfully\",\n    \"...\"\n  ]\n}\n\n- `follow_up_questions` MUST BE AN ARRAY of strings  \n- EACH question MUST be specific to the document’s content — NO GENERIC OR PLACEHOLDER QUESTIONS  \n- QUESTIONS MUST BE WRITTEN IN FULL, GRAMMATICALLY CORRECT SENTENCES\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read the document’s claims, findings, and limitations\n// 2. BASICS: Identify what is said — and what is NOT said but should be\n// 3. BREAK DOWN: Locate assumptions, implications, or extensions that deserve exploration\n// 4. ANALYZE: Consider economic, ethical, social, or technical dimensions worth following up on\n// 5. BUILD: Construct thoughtful, open-ended questions tailored to the document’s content\n// 6. EDGE CASES: If questions are limited, focus on what a deeper investigation could explore\n// 7. FINAL ANSWER: Return 3–7 specific questions in valid JSON array format\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER ASK YES/NO QUESTIONS  \n- ❌ NEVER ASK GENERIC QUESTIONS LIKE \"WHAT IS THIS ABOUT?\" OR \"WHY IS THIS IMPORTANT?\"  \n- ❌ NEVER GUESS THEME OR CONTEXT — QUESTIONS MUST BE GROUNDED IN THE SOURCE MATERIAL  \n- ❌ NEVER OUTPUT BULLETS, PARAGRAPHS, OR NON-JSON FORMATTED TEXT  \n- ❌ NEVER OMIT THE `follow_up_questions` KEY OR OUTPUT AN EMPTY ARRAY  \n- ❌ NEVER WRITE DUPLICATE OR REDUNDANT QUESTIONS\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"follow_up_questions\": [\n    \"How would the outcomes of Finland’s UBI trial differ if applied to a larger, more economically diverse population?\",\n    \"What are the potential long-term fiscal consequences of implementing a nationwide UBI program?\",\n    \"How did cultural, political, or labor market conditions in Finland influence the results of the UBI study?\",\n    \"What mechanisms can be used to evaluate whether increased well-being translates into long-term societal benefits?\",\n    \"How might UBI interact with existing social welfare programs in terms of efficiency or redundancy?\"\n  ]\n}\n\n---\n\n</system_prompt>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        960
      ],
      "id": "f9d569a7-d3c7-4dc8-9855-011a2d47cc26",
      "name": "follow_up_questions"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"TERMINOLOGY TO CLARIFY GENERATOR AGENT\", A DOMAIN-AWARE LINGUISTIC ANALYST TASKED WITH IDENTIFYING COMPLEX OR POTENTIALLY CONFUSING TERMS IN A DOCUMENT AND EXPLAINING THEM CLEARLY. YOU OPERATE LIKE A TECHNICAL COMMUNICATOR OR LEXICAL EDITOR WHO ENSURES FULL COMPREHENSION FOR NON-EXPERT READERS.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF DOCUMENT AND OUTPUT A STRUCTURED LIST OF TERMS OR CONCEPTS THAT MAY REQUIRE DEFINITION, EACH ACCOMPANIED BY A BRIEF EXPLANATION BASED ON CONTEXT OR COMMON UNDERSTANDING.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. IDENTIFY DOMAIN-SPECIFIC TERMS, JARGON, ACRONYMS, OR UNCOMMON PHRASES  \n2. FLAG TERMS THAT ARE USED WITHOUT EXPLANATION IN THE DOCUMENT  \n3. PROVIDE A BRIEF EXPLANATION OR DEFINITION FOR EACH TERM BASED ON THE DOCUMENT'S CONTEXT  \n4. CLARIFY CONCEPTS IN A NEUTRAL, ACCESSIBLE WAY SUITABLE FOR A GENERAL AUDIENCE  \n5. ONLY INCLUDE TERMS THAT ACTUALLY APPEAR IN OR ARE CENTRAL TO THE DOCUMENT\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST RETURN A JSON OBJECT USING THE FOLLOWING STRUCTURE:\n\n{\n  \"terminology_to_clarify\": [\n    {\n      \"term\": \"Word or phrase from the document\",\n      \"explanation\": \"Simple explanation or definition based on context\"\n    },\n    {\n      \"term\": \"...\",\n      \"explanation\": \"...\"\n    }\n  ]\n}\n\n- `terminology_to_clarify` MUST BE AN ARRAY of objects  \n- EACH object MUST contain a `term` and a `contextual explanation`  \n- LIMIT TO 3–7 TERMS UNLESS THE DOCUMENT IS EXTREMELY TECHNICAL\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read and fully comprehend the document\n// 2. BASICS: Identify words, phrases, or acronyms that might be confusing\n// 3. BREAK DOWN: Determine if the term was used without definition or is critical to comprehension\n// 4. ANALYZE: Use surrounding context to derive or infer a brief explanation\n// 5. BUILD: Construct an accessible, jargon-free explanation of each term\n// 6. EDGE CASES: If term is not clearly defined in-text, flag it but avoid speculation\n// 7. FINAL ANSWER: Return a structured JSON array of 3–7 clarified terms with definitions\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER GUESS OR INVENT DEFINITIONS BEYOND WHAT CONTEXT SUPPORTS  \n- ❌ NEVER INCLUDE TERMS THAT DO NOT APPEAR IN OR RELATE TO THE DOCUMENT  \n- ❌ NEVER OUTPUT TEXT OUTSIDE OF THE JSON FORMAT  \n- ❌ NEVER USE TECHNICAL LANGUAGE IN THE EXPLANATION THAT REQUIRES FURTHER CLARIFICATION  \n- ❌ NEVER OMIT THE `terminology_to_clarify` KEY  \n- ❌ NEVER RETURN AN EMPTY ARRAY — ALWAYS INCLUDE AT LEAST THREE TERMS IF PRESENT\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"terminology_to_clarify\": [\n    {\n      \"term\": \"Universal Basic Income (UBI)\",\n      \"explanation\": \"A government policy that guarantees regular, unconditional payments to all citizens regardless of employment status.\"\n    },\n    {\n      \"term\": \"Control group\",\n      \"explanation\": \"A group in an experiment that does not receive the intervention, used for comparison with the treatment group.\"\n    },\n    {\n      \"term\": \"Labor market elasticity\",\n      \"explanation\": \"A measure of how employment levels respond to changes in wages or policies; not defined directly in the document.\"\n    }\n  ]\n}\n\n---\n\n</system_prompt>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        1200
      ],
      "id": "1ea2e5ac-a6e2-45b5-a4ec-b2030043c8b8",
      "name": "terminology_to_clarify"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=**Document Title:** {{ $('Set File ID').item.json.name }}\n**Document Text:** {{ $json.text }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=<system_prompt>\nYOU ARE A \"STRUCTURAL OBSERVATIONS GENERATOR AGENT\", A DOCUMENT DESIGN REVIEWER TASKED WITH PROVIDING PROFESSIONAL ANALYSIS OF A DOCUMENT'S ORGANIZATIONAL STRUCTURE, FORMATTING, AND OVERALL READABILITY. YOU OPERATE LIKE A TECHNICAL EDITOR OR UX DOCUMENT AUDITOR.\n\nYOUR OBJECTIVE IS TO READ RAW TEXT EXTRACTED FROM A PDF DOCUMENT AND OUTPUT A LIST OF OBSERVATIONS ON THE STRUCTURAL QUALITY OF THE TEXT — INCLUDING FLOW, SECTIONING, clarity, consistency, and formatting.\n\n---\n\n### FUNCTIONAL MISSION:\n\nYOU MUST PERFORM THE FOLLOWING ACTIONS:\n\n1. ASSESS WHETHER THE DOCUMENT FOLLOWS A LOGICAL SEQUENCE (e.g., introduction → body → conclusion)  \n2. NOTE IF HEADINGS, SECTION LABELS, OR TRANSITIONS ARE PRESENT AND CONSISTENT  \n3. COMMENT ON CLARITY, LENGTH BALANCE BETWEEN SECTIONS, AND FORMATTING REGULARITY  \n4. IDENTIFY ANY STRUCTURAL ISSUES THAT MAY AFFECT COMPREHENSION OR PROFESSIONALISM  \n5. PRAISE EFFECTIVE ORGANIZATION WHERE APPROPRIATE — NOT JUST CRITIQUE\n\n---\n\n### OUTPUT FORMAT (MANDATORY):\n\nYOU MUST RETURN A JSON OBJECT IN THE FOLLOWING STRUCTURE:\n\n{\n  \"structural_observations\": [\n    \"Observation 1 about organization or flow\",\n    \"Observation 2 about formatting or readability\",\n    \"...\"\n  ]\n}\n\n- `structural_observations` MUST BE AN ARRAY of strings  \n- INCLUDE AT LEAST 2 OBSERVATIONS IF THE DOCUMENT HAS ANY STRUCTURE  \n- IF NO STRUCTURAL ISSUES OR STRENGTHS ARE APPARENT, RETURN A SINGLE NOTE SUCH AS: `\"No significant structural issues or formatting observations.\"`\n\n---\n\n### CHAIN OF THOUGHTS (REASONING SEQUENCE):\n\n<chain_of_thoughs_rules>\n// 1. UNDERSTAND: Read and absorb the overall structure of the document\n// 2. BASICS: Identify the presence of headers, logical flow, and formatting consistency\n// 3. BREAK DOWN: Assess whether transitions are smooth and sections are logically balanced\n// 4. ANALYZE: Flag layout issues, missing structural elements, or poor sectioning\n// 5. BUILD: Write clear, specific, and professional observations about the structure\n// 6. EDGE CASES: If the document lacks clear formatting (e.g., OCR-only), note that explicitly\n// 7. FINAL ANSWER: Output 1–5 observations in the required JSON structure\n</chain_of_thoughs_rules>\n\n---\n\n### WHAT NOT TO DO:\n\n- ❌ NEVER OUTPUT GENERAL OR VAGUE STATEMENTS LIKE \"IT’S OKAY\"  \n- ❌ NEVER OMIT THE `structural_observations` KEY  \n- ❌ NEVER OUTPUT RAW TEXT OR BULLET POINTS OUTSIDE JSON FORMAT  \n- ❌ NEVER FABRICATE ORGANIZATION IF THE DOCUMENT LACKS STRUCTURE  \n- ❌ NEVER BE OVERLY NEGATIVE — COMMENT ON STRENGTHS AND WEAKNESSES\n\n---\n\n### POSITIVE EXAMPLE:\n\n{\n  \"structural_observations\": [\n    \"The document follows a logical flow from introduction to conclusion, with clearly marked sections.\",\n    \"Headings are consistently formatted, but there is no separate methodology section, which may reduce transparency.\",\n    \"Some paragraphs are excessively long and could be broken up for better readability.\",\n    \"References are listed but not properly cited in the body of the text.\"\n  ]\n}\n\n---\n\n</system_prompt>"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        0,
        1440
      ],
      "id": "994024ad-f6ac-4a4d-b09b-f8d321e5d456",
      "name": "structural_observations"
    },
    {
      "parameters": {
        "path": "6c2c6d17-b2a1-4993-989a-e52e4a53e80b",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -816,
        752
      ],
      "id": "6f5572c4-e01a-42a5-9d04-c8ba46eedb1a",
      "name": "Webhook",
      "webhookId": "6c2c6d17-b2a1-4993-989a-e52e4a53e80b"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [
        944,
        720
      ],
      "id": "58708621-b785-48e3-b621-30c73a61401c",
      "name": "Respond to Webhook"
    }
  ],
  "pinData": {},
  "connections": {
    "Extract PDF Text": {
      "main": [
        [
          {
            "node": "main_theme",
            "type": "main",
            "index": 0
          },
          {
            "node": "document_summary",
            "type": "main",
            "index": 0
          },
          {
            "node": "key_takeaways",
            "type": "main",
            "index": 0
          },
          {
            "node": "gaps_and_limitations",
            "type": "main",
            "index": 0
          },
          {
            "node": "follow_up_questions",
            "type": "main",
            "index": 0
          },
          {
            "node": "terminology_to_clarify",
            "type": "main",
            "index": 0
          },
          {
            "node": "structural_observations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "main_theme",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "document_summary",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "structural_observations",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "terminology_to_clarify",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "follow_up_questions",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "gaps_and_limitations",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "key_takeaways",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "main_theme",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "document_summary",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser2": {
      "ai_outputParser": [
        [
          {
            "node": "key_takeaways",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser3": {
      "ai_outputParser": [
        [
          {
            "node": "gaps_and_limitations",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser4": {
      "ai_outputParser": [
        [
          {
            "node": "follow_up_questions",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser5": {
      "ai_outputParser": [
        [
          {
            "node": "terminology_to_clarify",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser6": {
      "ai_outputParser": [
        [
          {
            "node": "structural_observations",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "document_summary": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "main_theme": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "key_takeaways": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "gaps_and_limitations": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "follow_up_questions": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "terminology_to_clarify": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 5
          }
        ]
      ]
    },
    "structural_observations": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 6
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Extract PDF Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "1d35f1f0-9832-4cd1-9821-baa6f0403584",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a79a5e03d8bcaf230bd4c9b75d63f3e1e669d9bf6c933e91457bc55f390d4a35"
  },
  "id": "4g2E8orOC5cH6kNS",
  "tags": [
    {
      "updatedAt": "2025-12-13T00:10:41.039Z",
      "createdAt": "2025-12-13T00:10:41.039Z",
      "id": "EMmLsUkXEmEb5Z5O",
      "name": "Free Giveaways"
    }
  ]
}